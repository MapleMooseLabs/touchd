"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var o=e[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,s,o){return s&&t(e.prototype,s),o&&t(e,o),e}}(),CustomEvent=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var s=document.createEvent("CustomEvent");return s.initCustomEvent(t,e,e.cancelable,e.detail),s};CustomEvent.prototype=window.CustomEvent.prototype,window.CustomEvent=CustomEvent;var Touchd=function(){function t(e){_classCallCheck(this,t),this.threshold=200,this.el="object"===("undefined"==typeof e?"undefined":_typeof(e))?e:document.getElementById(e),this.gestures={swipe:null,tap:null},this.prevents={swipe:!1,tap:!1},this.init()}return _createClass(t,[{key:"resetTouches",value:function(){this.touches={touchstart:{x:-1,y:-1},touchmove:{x:-1,y:-1},touchend:!1,direction:null}}},{key:"swipe",value:function(){var t=new CustomEvent("swipe",{bubbles:!1,cancelable:!1,detail:{direction:this.touches.direction}});t.initialTarget=this.target,this.el.dispatchEvent(t),"function"==typeof this.gestures.swipe&&(this.gestures.swipe(t),this.resetTouches())}},{key:"tap",value:function(){var t=new CustomEvent("tap",{bubbles:!1,cancelable:!1,detail:{direction:this.touches.direction}});t.initialTarget=this.target,this.el.dispatchEvent(t),"function"==typeof this.gestures.tap&&(this.gestures.tap(t),this.resetTouches())}},{key:"handleTouch",value:function(t){var e=void 0;if(void 0!==("undefined"==typeof t?"undefined":_typeof(t))&&void 0!==_typeof(t.touches))if(e=t.touches[0],this.target=t.target,"touchstart"===t.type||"touchmove"===t.type)this.touches[t.type].x=e.pageX,this.touches[t.type].y=e.pageY;else if("touchend"===t.type)if(this.touches[t.type]=!0,this.touches.touchstart.x>-1&&this.touches.touchmove.x>-1){var s=this.touches.touchstart.x-this.touches.touchmove.x,o=this.touches.touchstart.y-this.touches.touchmove.y;(Math.abs(s)>=this.threshold||Math.abs(o)>=this.threshold)&&(this.prevents.swipe&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()),Math.abs(s)>Math.abs(o)?this.touches.direction=this.touches.touchstart.x<this.touches.touchmove.x?"right":"left":this.touches.direction=this.touches.touchstart.y<this.touches.touchmove.y?"up":"down",this.swipe())}else this.prevents.tap&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()),this.tap()}},{key:"init",value:function(){this.resetTouches(),this.el.addEventListener("touchstart",this.handleTouch.bind(this),!1),this.el.addEventListener("touchmove",this.handleTouch.bind(this),!1),this.el.addEventListener("touchend",this.handleTouch.bind(this),!1)}},{key:"on",value:function(t,e,s){this.gestures[t]=e,this.prevents[t]=s||!1}},{key:"threshold",value:function(t){return t&&(this.threshold=t),this.threshold}}]),t}();exports.default=Touchd,module.exports=exports.default;