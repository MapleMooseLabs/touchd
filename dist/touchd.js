"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),CustomEvent=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var s=document.createEvent("CustomEvent");return s.initCustomEvent(t,e,e.cancelable,e.detail),s};CustomEvent.prototype=window.CustomEvent.prototype,window.CustomEvent=CustomEvent;var DEFAULT_OPTIONS={swipeThreshold:200,swipeTimeout:500,panThreshold:10},Touchd=function(){function t(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),this.swipeThreshold=s.swipeThreshold?s.swipeThreshold:DEFAULT_OPTIONS.swipeThreshold,this.swipeTimeout=s.swipeTimeout?s.swipeTimeout:DEFAULT_OPTIONS.swipeTimeout,this.panThreshold=s.panThreshold?s.panThreshold:DEFAULT_OPTIONS.panThreshold,this.el="object"===("undefined"==typeof e?"undefined":_typeof(e))?e:document.getElementById(e),this.gestures={pan:null,swipe:null,tap:null},this.prevents={pan:!1,swipe:!1,tap:!1},this.init()}return _createClass(t,[{key:"resetTouches",value:function(){this.touches={touchstart:{x:-1,y:-1,t:0},touchmove:{x:-1,y:-1,t:0},touchend:!1,direction:null}}},{key:"delta",value:function(){return{x:this.touches.touchstart.x-this.touches.touchmove.x,y:this.touches.touchstart.y-this.touches.touchmove.y}}},{key:"direction",value:function t(){var e=(this.touches,this.delta()),t=void 0;return t=Math.abs(e.x)>Math.abs(e.y)?this.touches.touchstart.x<this.touches.touchmove.x?"right":"left":this.touches.touchstart.y<this.touches.touchmove.y?"down":"up"}},{key:"pan",value:function(){var t={direction:this.direction(),delta:this.delta(),initialTarget:this.target},e=new CustomEvent("pan",{bubbles:!1,cancelable:!0,detail:t});this.el.dispatchEvent(e),"function"==typeof this.gestures.pan&&this.gestures.pan(e)}},{key:"swipe",value:function(){var t={direction:this.direction(),delta:this.delta(),initialTarget:this.target},e=new CustomEvent("swipe",{bubbles:!1,cancelable:!0,detail:t});this.el.dispatchEvent(e),"function"==typeof this.gestures.swipe&&this.gestures.swipe(e),this.resetTouches()}},{key:"tap",value:function(){var t={initialTarget:this.target},e=new CustomEvent("tap",{bubbles:!1,cancelable:!0,detail:t});this.el.dispatchEvent(e),"function"==typeof this.gestures.tap&&this.gestures.tap(e),this.resetTouches()}},{key:"handleTouch",value:function(t){var e=void 0,s=this.delta();if(void 0!==("undefined"==typeof t?"undefined":_typeof(t))&&void 0!==_typeof(t.touches))if(e=t.touches[0],this.target=t.target,"touchstart"===t.type||"touchmove"===t.type)this.touches[t.type].x=e.pageX,this.touches[t.type].y=e.pageY,this.touches[t.type].t=t.timeStamp,"touchmove"===t.type&&(Math.abs(s.x)>=this.panThreshold||Math.abs(s.y)>=this.panThreshold)&&(this.prevents.pan&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()),this.pan());else if("touchend"===t.type){var i=t.timeStamp-this.touches.touchstart.t;this.touches[t.type]=!0,i<=this.swipeTimeout&&(this.touches.touchstart.x>-1&&this.touches.touchmove.x>-1||this.touches.touchstart.y>-1&&this.touches.touchmove.y>-1)?(Math.abs(s.x)>=this.swipeThreshold||Math.abs(s.y)>=this.swipeThreshold)&&(this.prevents.swipe&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()),this.swipe()):(this.prevents.tap&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()),this.tap())}}},{key:"init",value:function(){this.resetTouches(),this.el.addEventListener("touchstart",this.handleTouch.bind(this),!1),this.el.addEventListener("touchmove",this.handleTouch.bind(this),!1),this.el.addEventListener("touchend",this.handleTouch.bind(this),!1)}},{key:"on",value:function(t,e,s){this.gestures[t]=e,this.prevents[t]=s||!1}},{key:"swipeThreshold",value:function(t){return t&&(this.swipeThreshold=t),this.swipeThreshold}}]),t}();exports.default=Touchd,module.exports=exports.default;